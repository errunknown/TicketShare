<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biliet≈≥ Bendrinimas</title>
    <style>
        :root {
            --primary-color: #4285f4;
            --secondary-color: #34a853;
            --danger-color: #ea4335;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --border-radius: 8px;
            --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            position: relative;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            min-width: 200px;
            display: none;
            z-index: 1000;
        }

        .user-dropdown.active {
            display: block;
        }

        .user-dropdown-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .user-dropdown-item:hover {
            background-color: #f5f5f5;
        }

        .user-dropdown-item:last-child {
            border-bottom: none;
            color: var(--danger-color);
        }

        .admin-badge {
            background: var(--danger-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 5px;
        }
        
        /* Login Page */
        .login-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
            text-align: center;
        }
        
        .login-card {
            background: white;
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 400px;
            width: 100%;
        }
        
        .login-card h1 {
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .google-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background-color: white;
            color: var(--dark-color);
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }
        
        .google-btn:hover {
            background-color: #f5f5f5;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .google-icon {
            width: 20px;
            height: 20px;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal h2 {
            margin-bottom: 20px;
        }

        .profile-edit-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-color);
            color: white;
            font-size: 40px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
        }

        .profile-edit-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-edit-avatar:hover::after {
            content: 'Change';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            font-size: 12px;
        }
        
        /* Main Page */
        .main-page {
            display: none;
        }

        .announcement-banner {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            display: none;
        }

        .announcement-banner.active {
            display: block;
        }

        .announcement-banner h3 {
            margin-bottom: 5px;
        }
        
        .page-title {
            margin: 20px 0;
            color: var(--dark-color);
        }

        .admin-btn {
            background-color: var(--danger-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .add-ticket-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tickets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .ticket-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: transform 0.3s;
        }
        
        .ticket-card:hover {
            transform: translateY(-5px);
        }
        
        .ticket-header {
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ticket-discount {
            background-color: var(--secondary-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .ticket-body {
            padding: 15px;
        }
        
        .ticket-qr {
            width: 100%;
            height: 200px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .ticket-qr img {
            max-width: 100%;
            max-height: 100%;
        }
        
        .ticket-expiry {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .ticket-actions {
            display: flex;
            justify-content: space-between;
        }
        
        .prepare-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 8px 15px;
            cursor: pointer;
            flex-grow: 1;
            margin-right: 10px;
        }
        
        .delete-btn {
            background-color: var(--danger-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 8px 15px;
            cursor: pointer;
        }
        
        /* Add Ticket Form */
        .add-ticket-form {
            display: none;
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 500px;
            margin: 0 auto 40px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        /* Admin Panel */
        .admin-panel {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 40px;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            color: #666;
            border-bottom: 3px solid transparent;
        }

        .admin-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .user-list {
            list-style: none;
        }

        .user-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .user-list-item:last-child {
            border-bottom: none;
        }

        .user-list-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-list-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .user-list-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ban-btn {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
        }

        .banned-tag {
            background: #666;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* Fullscreen Ticket Preview */
        .fullscreen-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f5f5f5;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .fullscreen-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .ticket-preview {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            margin: 20px;
        }

        .ticket-header-preview {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: #f8f8f8;
            border-bottom: 1px solid #e0e0e0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .dropdown-btn {
            width: 50px;
            height: 50px;
            background: #00b300;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            position: relative;
        }

        .dropdown-btn::after {
            content: '';
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 10px solid white;
            transform: rotate(-90deg);
        }

        .ticket-info-preview h1 {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }

        .phone-number {
            font-size: 16px;
            color: #666;
        }

        .info-btn {
            width: 30px;
            height: 30px;
            border: 2px solid #666;
            border-radius: 50%;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #666;
        }

        .qr-section {
            background: #00b300;
            padding: 30px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .qr-container {
            position: relative;
            width: 220px;
            height: 220px;
        }

        .qr-code {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        .circle-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 240px;
            height: 240px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
        }

        .circle-animation:nth-child(2) {
            animation-delay: 0.5s;
        }

        .circle-animation:nth-child(3) {
            animation-delay: 1s;
        }

        @keyframes pulse {
            0% {
                width: 220px;
                height: 220px;
                opacity: 1;
            }
            100% {
                width: 280px;
                height: 280px;
                opacity: 0;
            }
        }

        .qr-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qr-placeholder img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .ticket-details {
            padding: 20px;
        }

        .duration-badge {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .bus-icon {
            width: 50px;
            height: 50px;
            background: #00b300;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .duration-info h2 {
            font-size: 22px;
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }

        .price-ticket {
            font-size: 14px;
            color: #666;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 17px;
            color: #333;
            font-weight: 400;
        }

        .detail-value {
            font-size: 17px;
            color: #333;
            font-weight: 600;
            text-align: right;
        }

        .time-left-value {
            font-size: 17px;
            font-weight: 600;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .tickets-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: row;
                gap: 10px;
            }
            
            .add-ticket-form, .admin-panel {
                margin: 0 10px 40px;
                padding: 20px;
            }
            
            .ticket-preview {
                margin: 0;
                border-radius: 0;
                max-width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            .qr-section {
                flex: 1;
                display: flex;
                align-items: center;
            }

            .button-group {
                flex-direction: column;
            }

            .admin-tabs {
                overflow-x: auto;
            }
        }

        @media (min-width: 769px) {
            .fullscreen-overlay.active {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="mainHeader">
        <div class="container">
            <div class="header-content">
                <div class="logo">Biliet≈≥ Bendrinimas</div>
                <div class="user-info" id="userInfoDropdown">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="userName">Vartotojas</span>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="user-dropdown-item" id="editProfileBtn">Redaguoti profilƒØ</div>
                        <div class="user-dropdown-item" id="logoutBtn">Atsijungti</div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Login Page -->
    <div class="container">
        <div class="login-page" id="loginPage">
            <div class="login-card">
                <h1>Prisijunkite</h1>
                <p>Norƒódami naudotis platforma, prisijunkite su savo Google paskyra</p>
                <button class="google-btn" id="googleLoginBtn">
                    <svg class="google-icon" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Prisijungti su Google
                </button>
            </div>
        </div>
        
        <!-- Main Page -->
        <div class="main-page" id="mainPage">
            <!-- Announcement Banner -->
            <div class="announcement-banner" id="announcementBanner">
                <h3>üì¢ Prane≈°imas</h3>
                <p id="announcementText"></p>
            </div>

            <h1 class="page-title">Bendrinami Bilietai</h1>
            
            <div class="button-group">
                <button class="add-ticket-btn" id="addTicketBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Pridƒóti BilietƒÖ
                </button>
                <button class="admin-btn" id="adminPanelBtn" style="display: none;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 15a3 3 0 100-6 3 3 0 000 6z"/>
                        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                    </svg>
                    Admin Panel
                </button>
            </div>

            <!-- Admin Panel -->
            <div class="admin-panel" id="adminPanel" style="display: none;">
                <h2>Admin Panel</h2>
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="users">Vartotojai</button>
                    <button class="admin-tab" data-tab="announcements">Prane≈°imai</button>
                </div>
                
                <div class="admin-content active" id="usersTab">
                    <ul class="user-list" id="userList"></ul>
                </div>
                
                <div class="admin-content" id="announcementsTab">
                    <div class="form-group">
                        <label for="announcementTitle">Prane≈°imo antra≈°tƒó</label>
                        <input type="text" id="announcementTitle" class="form-control" placeholder="ƒÆveskite antra≈°tƒô">
                    </div>
                    <div class="form-group">
                        <label for="announcementMessage">Prane≈°imo tekstas</label>
                        <textarea id="announcementMessage" class="form-control" placeholder="ƒÆveskite prane≈°imƒÖ"></textarea>
                    </div>
                    <button class="btn btn-primary" id="sendAnnouncementBtn">Si≈≥sti prane≈°imƒÖ</button>
                </div>
            </div>
            
            <!-- Add Ticket Form -->
            <div class="add-ticket-form" id="addTicketForm">
                <h2>Pridƒóti naujƒÖ bilietƒÖ</h2>
                <div class="form-group">
                    <label for="ticketImage">QR kodo nuotrauka</label>
                    <input type="file" id="ticketImage" class="form-control" accept="image/*">
                    <small>ƒÆkelkite QR kodo nuotraukƒÖ</small>
                </div>
                <div class="form-group">
                    <label for="expiryDate">Galiojimo data</label>
                    <input type="datetime-local" id="expiryDate" class="form-control">
                </div>
                <div class="form-group">
                    <label for="discount">Nuolaida</label>
                    <select id="discount" class="form-control">
                        <option value="0%">0%</option>
                        <option value="10%">10%</option>
                        <option value="20%">20%</option>
                        <option value="30%">30%</option>
                        <option value="50%">50%</option>
                        <option value="100%">Nemokamai</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="duration">Trukmƒó (minutƒómis)</label>
                    <input type="number" id="duration" class="form-control" value="60">
                </div>
                <div class="form-group">
                    <label for="price">Kaina (‚Ç¨)</label>
                    <input type="number" id="price" class="form-control" step="0.01" value="0.25">
                </div>
                <div class="form-group">
                    <label for="phone">Telefono numeris</label>
                    <input type="text" id="phone" class="form-control" value="+3706xxxx726">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" id="cancelAddTicket">At≈°aukti</button>
                    <button class="btn btn-primary" id="saveTicket">I≈°saugoti</button>
                </div>
            </div>
            
            <!-- Tickets Grid -->
            <div class="tickets-grid" id="ticketsGrid">
                <!-- Tickets will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <h2>Redaguoti profilƒØ</h2>
            <div class="profile-edit-avatar" id="profileAvatar">
                <span id="profileAvatarText">U</span>
            </div>
            <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
            <div class="form-group">
                <label for="profileName">Vardas</label>
                <input type="text" id="profileName" class="form-control">
            </div>
            <div class="form-group">
                <label for="profileEmail">El. pa≈°tas</label>
                <input type="email" id="profileEmail" class="form-control" readonly>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancelProfileEdit">At≈°aukti</button>
                <button class="btn btn-primary" id="saveProfile">I≈°saugoti</button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Ticket Preview -->
    <div class="fullscreen-overlay" id="fullscreenOverlay">
        <div class="ticket-preview" id="ticketPreview">
            <div class="ticket-header-preview">
                <div class="header-left">
                    <button class="dropdown-btn" id="backBtn" aria-label="Back"></button>
                    <div class="ticket-info-preview">
                        <h4>Active ticket</h4>
                        <div class="phone-number" id="previewPhone">+3706xxxx726</div>
                    </div>
                </div>
                <button class="info-btn" aria-label="Information">i</button>
            </div>

            <div class="qr-section">
                <div class="qr-container">
                    <div class="circle-animation"></div>
                    <div class="circle-animation"></div>
                    <div class="circle-animation"></div>
                    <div class="qr-code">
                        <div class="qr-placeholder">
                            <img id="previewQrImage" src="" alt="QR kodas">
                        </div>
                    </div>
                </div>
            </div>

            <div class="ticket-details">
                <div class="duration-badge">
                    <div class="bus-icon">üöå</div>
                    <div class="duration-info">
                        <h4 id="previewDuration">60 minuƒçi≈≥</h4>
                        <div class="price-ticket" id="previewPrice">0,25 ‚Ç¨ ¬∑ Nr. 109240746</div>
                    </div>
                </div>

                <div class="detail-row">
                    <div class="detail-label">Time left</div>
                    <div class="detail-value time-left-value" id="timeLeft">58:05</div>
                </div>

                <div class="detail-row">
                    <div class="detail-label">Start</div>
                    <div class="detail-value" id="startTime">2025-11-04 7:48 PM</div>
                </div>

                <div class="detail-row">
                    <div class="detail-label">End</div>
                    <div class="detail-value" id="endTime">2025-11-04 8:48 PM</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // In-memory storage for users and data
        let users = [
            {
                id: 1,
                name: "Admin User",
                email: "admin@example.com",
                avatar: null,
                isAdmin: true,
                isBanned: false
            },
            {
                id: 2,
                name: "Jonas Petraitis",
                email: "jonas@example.com",
                avatar: null,
                isAdmin: false,
                isBanned: false
            },
            {
                id: 3,
                name: "Ona Kazlauskaitƒó",
                email: "ona@example.com",
                avatar: null,
                isAdmin: false,
                isBanned: false
            }
        ];

        let currentAnnouncement = null;

        // Sample tickets
        const sampleTickets = [
            {
                id: 1,
                qrCode: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='white' width='100' height='100'/%3E%3Crect x='5' y='5' width='15' height='15'/%3E%3Crect x='80' y='5' width='15' height='15'/%3E%3Crect x='5' y='80' width='15' height='15'/%3E%3C/svg%3E",
                expiryDate: "2025-11-05T20:00",
                discount: "20%",
                ownerId: 2,
                isActive: true,
                phone: "+3706xxxx726",
                duration: 60,
                price: 0.25
            },
            {
                id: 2,
                qrCode: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='white' width='100' height='100'/%3E%3Crect x='5' y='5' width='15' height='15'/%3E%3Crect x='80' y='5' width='15' height='15'/%3E%3Crect x='5' y='80' width='15' height='15'/%3E%3C/svg%3E",
                expiryDate: "2025-11-06T15:30",
                discount: "50%",
                ownerId: 3,
                isActive: true,
                phone: "+3706xxxx123",
                duration: 45,
                price: 0.15
            }
        ];

        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const mainPage = document.getElementById('mainPage');
        const mainHeader = document.getElementById('mainHeader');
        const googleLoginBtn = document.getElementById('googleLoginBtn');
        const userInfoDropdown = document.getElementById('userInfoDropdown');
        const userDropdown = document.getElementById('userDropdown');
        const editProfileBtn = document.getElementById('editProfileBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const addTicketBtn = document.getElementById('addTicketBtn');
        const adminPanelBtn = document.getElementById('adminPanelBtn');
        const adminPanel = document.getElementById('adminPanel');
        const addTicketForm = document.getElementById('addTicketForm');
        const cancelAddTicket = document.getElementById('cancelAddTicket');
        const saveTicket = document.getElementById('saveTicket');
        const ticketsGrid = document.getElementById('ticketsGrid');
        const fullscreenOverlay = document.getElementById('fullscreenOverlay');
        const backBtn = document.getElementById('backBtn');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const profileModal = document.getElementById('profileModal');
        const profileAvatar = document.getElementById('profileAvatar');
        const profileAvatarText = document.getElementById('profileAvatarText');
        const avatarUpload = document.getElementById('avatarUpload');
        const profileName = document.getElementById('profileName');
        const profileEmail = document.getElementById('profileEmail');
        const cancelProfileEdit = document.getElementById('cancelProfileEdit');
        const saveProfile = document.getElementById('saveProfile');
        const announcementBanner = document.getElementById('announcementBanner');
        const announcementText = document.getElementById('announcementText');
        const userList = document.getElementById('userList');
        const sendAnnouncementBtn = document.getElementById('sendAnnouncementBtn');

        // Current user and tickets
        let currentUser = null;
        let userTickets = [...sampleTickets];
        let activeTimer = null;

        // Google Sign-In (simulated with real Google OAuth flow structure)
        googleLoginBtn.addEventListener('click', () => {
            // In production, this would use: gapi.auth2.getAuthInstance().signIn()
            // For demo purposes, we'll simulate login with the first user
            simulateGoogleLogin();
        });

        function simulateGoogleLogin() {
            // Simulate selecting a user - in production this would be actual Google OAuth
            const user = users[0]; // Login as admin for demo
            loginUser(user);
        }

        function loginUser(user) {
            if (user.isBanned) {
                alert('J≈´s≈≥ paskyra u≈æblokuota. Susisiekite su administratoriumi.');
                return;
            }

            currentUser = user;
            updateUserDisplay();
            
            loginPage.style.display = 'none';
            mainPage.style.display = 'block';
            
            if (currentUser.isAdmin) {
                adminPanelBtn.style.display = 'flex';
            }

            renderTickets();
            displayAnnouncement();
        }

        function updateUserDisplay() {
            if (currentUser.avatar) {
                userAvatar.innerHTML = `<img src="${currentUser.avatar}" alt="${currentUser.name}">`;
                profileAvatar.innerHTML = `<img src="${currentUser.avatar}" alt="${currentUser.name}">`;
            } else {
                const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
                userAvatar.textContent = initials;
                profileAvatarText.textContent = initials;
            }
            userName.innerHTML = currentUser.name + (currentUser.isAdmin ? '<span class="admin-badge">Admin</span>' : '');
        }

        // User dropdown toggle
        userInfoDropdown.addEventListener('click', (e) => {
            e.stopPropagation();
            userDropdown.classList.toggle('active');
        });

        document.addEventListener('click', () => {
            userDropdown.classList.remove('active');
        });

        // Edit profile
        editProfileBtn.addEventListener('click', () => {
            profileName.value = currentUser.name;
            profileEmail.value = currentUser.email;
            profileModal.classList.add('active');
            userDropdown.classList.remove('active');
        });

        profileAvatar.addEventListener('click', () => {
            avatarUpload.click();
        });

        avatarUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = `<img src="${e.target.result}" alt="Avatar">`;
                    profileAvatar.innerHTML = img;
                };
                reader.readAsDataURL(file);
            }
        });

        cancelProfileEdit.addEventListener('click', () => {
            profileModal.classList.remove('active');
        });

        saveProfile.addEventListener('click', () => {
            currentUser.name = profileName.value;
            
            const img = profileAvatar.querySelector('img');
            if (img) {
                currentUser.avatar = img.src;
            }
            
            // Update in users array
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
            }
            
            updateUserDisplay();
            profileModal.classList.remove('active');
            renderTickets();
        });

        // Logout
        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            loginPage.style.display = 'flex';
            mainPage.style.display = 'none';
            adminPanelBtn.style.display = 'none';
            adminPanel.style.display = 'none';
            userDropdown.classList.remove('active');
        });

        // Admin panel
        adminPanelBtn.addEventListener('click', () => {
            if (adminPanel.style.display === 'none') {
                adminPanel.style.display = 'block';
                renderUserList();
            } else {
                adminPanel.style.display = 'none';
            }
        });

        // Admin tabs
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                const tabName = tab.dataset.tab;
                document.getElementById(tabName + 'Tab').classList.add('active');
            });
        });

        // Render user list
        function renderUserList() {
            userList.innerHTML = '';
            users.forEach(user => {
                if (user.id === currentUser.id) return; // Don't show current user
                
                const li = document.createElement('li');
                li.className = 'user-list-item';
                
                const avatarHtml = user.avatar 
                    ? `<img src="${user.avatar}" alt="${user.name}">`
                    : user.name.split(' ').map(n => n[0]).join('').toUpperCase();
                
                li.innerHTML = `
                    <div class="user-list-info">
                        <div class="user-list-avatar">${avatarHtml}</div>
                        <div>
                            <div>${user.name} ${user.isAdmin ? '<span class="admin-badge">Admin</span>' : ''}</div>
                            <small>${user.email}</small>
                        </div>
                    </div>
                    ${user.isBanned 
                        ? '<span class="banned-tag">U≈æblokuotas</span>'
                        : `<button class="ban-btn" data-user-id="${user.id}">Blokuoti</button>`
                    }
                `;
                
                userList.appendChild(li);
            });

            // Add ban button listeners
            document.querySelectorAll('.ban-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = parseInt(e.target.dataset.userId);
                    banUser(userId);
                });
            });
        }

        // Ban user
        function banUser(userId) {
            if (confirm('Ar tikrai norite u≈æblokuoti ≈°ƒØ vartotojƒÖ?')) {
                const user = users.find(u => u.id === userId);
                if (user) {
                    user.isBanned = true;
                    renderUserList();
                    alert(`Vartotojas ${user.name} u≈æblokuotas.`);
                }
            }
        }

        // Send announcement
        sendAnnouncementBtn.addEventListener('click', () => {
            const title = document.getElementById('announcementTitle').value;
            const message = document.getElementById('announcementMessage').value;
            
            if (!title || !message) {
                alert('U≈æpildykite visus laukus');
                return;
            }
            
            currentAnnouncement = { title, message };
            displayAnnouncement();
            
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementMessage').value = '';
            
            alert('Prane≈°imas i≈°si≈≥stas visiems vartotojams!');
        });

        // Display announcement
        function displayAnnouncement() {
            if (currentAnnouncement) {
                announcementText.innerHTML = `<strong>${currentAnnouncement.title}:</strong> ${currentAnnouncement.message}`;
                announcementBanner.classList.add('active');
            }
        }

        // Show add ticket form
        addTicketBtn.addEventListener('click', () => {
            addTicketForm.style.display = 'block';
            addTicketBtn.style.display = 'none';
        });

        // Hide add ticket form
        cancelAddTicket.addEventListener('click', () => {
            addTicketForm.style.display = 'none';
            addTicketBtn.style.display = 'flex';
        });

        // Save new ticket
        saveTicket.addEventListener('click', () => {
            const ticketImage = document.getElementById('ticketImage').files[0];
            const expiryDate = document.getElementById('expiryDate').value;
            const discount = document.getElementById('discount').value;
            const duration = document.getElementById('duration').value;
            const price = document.getElementById('price').value;
            const phone = document.getElementById('phone').value;
            
            if (!ticketImage || !expiryDate) {
                alert('Pra≈°ome u≈æpildyti visus laukus');
                return;
            }
            
            const newTicket = {
                id: userTickets.length + 1,
                qrCode: URL.createObjectURL(ticketImage),
                expiryDate: expiryDate,
                discount: discount,
                ownerId: currentUser.id,
                isActive: true,
                phone: phone,
                duration: parseInt(duration),
                price: parseFloat(price)
            };
            
            userTickets.unshift(newTicket);
            renderTickets();
            
            document.getElementById('ticketImage').value = '';
            document.getElementById('expiryDate').value = '';
            document.getElementById('discount').value = '0%';
            document.getElementById('duration').value = '60';
            document.getElementById('price').value = '0.25';
            document.getElementById('phone').value = '+3706xxxx726';
            
            addTicketForm.style.display = 'none';
            addTicketBtn.style.display = 'flex';
        });

        // Render tickets
        function renderTickets() {
            ticketsGrid.innerHTML = '';
            
            userTickets.forEach(ticket => {
                if (!ticket.isActive) return;
                
                const owner = users.find(u => u.id === ticket.ownerId);
                if (!owner || owner.isBanned) return;
                
                const ticketElement = document.createElement('div');
                ticketElement.className = 'ticket-card';
                
                const expiryDate = new Date(ticket.expiryDate);
                const now = new Date();
                const isExpired = expiryDate < now;
                
                if (isExpired) {
                    ticket.isActive = false;
                    return;
                }
                
                ticketElement.innerHTML = `
                    <div class="ticket-header">
                        <span>${owner.name}</span>
                        <span class="ticket-discount">${ticket.discount}</span>
                    </div>
                    <div class="ticket-body">
                        <div class="ticket-qr">
                            <img src="${ticket.qrCode}" alt="QR kodas">
                        </div>
                        <div class="ticket-expiry">Galioja iki: ${formatDate(expiryDate)}</div>
                        <div class="ticket-actions">
                            <button class="prepare-btn" data-id="${ticket.id}">Paruo≈°ti</button>
                            ${ticket.ownerId === currentUser.id ? 
                                `<button class="delete-btn" data-id="${ticket.id}">Pa≈°alinti</button>` : 
                                ''}
                        </div>
                    </div>
                `;
                
                ticketsGrid.appendChild(ticketElement);
            });
            
            document.querySelectorAll('.prepare-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const ticketId = parseInt(e.target.getAttribute('data-id'));
                    showTicketPreview(ticketId);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const ticketId = parseInt(e.target.getAttribute('data-id'));
                    deleteTicket(ticketId);
                });
            });
        }

        // Show ticket preview in fullscreen
        function showTicketPreview(ticketId) {
            const ticket = userTickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('previewQrImage').src = ticket.qrCode;
            document.getElementById('previewPhone').textContent = ticket.phone;
            document.getElementById('previewDuration').textContent = ticket.duration + " minuƒçi≈≥";
            document.getElementById('previewPrice').textContent = ticket.price.toFixed(2) + " ‚Ç¨ ¬∑ Nr. " + (109240746 + ticket.id);
            
            const expiryDate = new Date(ticket.expiryDate);
            const durationMinutes = ticket.duration;
            const startDate = new Date(expiryDate.getTime() - durationMinutes * 60 * 1000);
            
            document.getElementById('startTime').textContent = formatDateTime(startDate);
            document.getElementById('endTime').textContent = formatDateTime(expiryDate);
            
            startCountdown(expiryDate);
            
            mainHeader.style.display = 'none';
            fullscreenOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Start countdown timer
        function startCountdown(expiryDate) {
            if (activeTimer) {
                clearInterval(activeTimer);
            }
            
            function updateTimer() {
                const now = new Date();
                const diff = expiryDate.getTime() - now.getTime();
                
                if (diff <= 0) {
                    document.getElementById('timeLeft').textContent = '00:00';
                    clearInterval(activeTimer);
                    return;
                }
                
                const minutes = Math.floor(diff / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('timeLeft').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateTimer();
            activeTimer = setInterval(updateTimer, 1000);
        }

        // Delete ticket
        function deleteTicket(ticketId) {
            if (confirm('Ar tikrai norite pa≈°alinti ≈°ƒØ bilietƒÖ?')) {
                userTickets = userTickets.filter(t => t.id !== ticketId);
                renderTickets();
            }
        }

        // Back button from fullscreen preview
        backBtn.addEventListener('click', () => {
            fullscreenOverlay.classList.remove('active');
            mainHeader.style.display = 'block';
            document.body.style.overflow = 'auto';
            
            if (activeTimer) {
                clearInterval(activeTimer);
                activeTimer = null;
            }
        });

        // Helper functions
        function formatDate(date) {
            return date.toLocaleDateString('lt-LT', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function formatDateTime(date) {
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });
        }
    </script>
</body>
</html>
